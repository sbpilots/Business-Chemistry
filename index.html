<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Custom Assistant</title>
</head>
<body>
    <h1>Chat with Your Custom Assistant</h1>

    <div>
        <label for="userInput">Ask your question:</label>
        <input type="text" id="userInput" placeholder="Type your question here">
        <button onclick="startConversation()">Submit</button> <!-- Button triggering startConversation() -->
    </div>

    <div id="responseOutput"></div>

    <script>
        const apiKey = 'sk-ei7SXJlpPla9GQZdF3xivyfH9u3mJiY3cAqj9XmhkzT3BlbkFJbOiaQh_i4AEYOSSswQzmywXFV7zY48ePuhjOv2bJMA'; // Replace with your OpenAI API key

        // Function to make a call to the Chat Completions API (GPT-4)
        async function createRun(userInput) {
            console.log('Creating run...'); // Log step
            const response = await fetch(`https://api.openai.com/v1/chat/completions`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-4',
                    messages: [
                        { role: 'user', content: userInput }
                    ],
                    max_tokens: 100
                })
            });
            const data = await response.json();
            console.log('Run created:', data); // Log success
            return data;
        }

        // Full conversation flow: Create run, and display the response
        async function startConversation() {
            console.log('Button clicked!'); // Log when the button is clicked
            const userInput = document.getElementById('userInput').value;
            const responseOutput = document.getElementById('responseOutput');

            if (!userInput) {
                responseOutput.innerText = 'Please enter a question.';
                return;
            }

            try {
                const runData = await createRun(userInput); // Create a run to process the message
                const assistantResponse = runData.choices[0].message.content; // Fetch assistant's response

                responseOutput.innerText = assistantResponse;
            } catch (error) {
                console.error('Error during conversation flow:', error); // Log error
                responseOutput.innerText = `Error: ${error.message}`;
            }
        }
    </script>

</body>
</html>
